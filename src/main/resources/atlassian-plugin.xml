<?xml version="1.0" encoding="UTF-8"?>
<atlassian-plugin key="${atlassian.plugin.key}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}"/>

        <param name="plugin-icon">images/pluginIcon.png</param>
        <param name="plugin-logo">images/pluginLogo.png</param>
        <param name="configure.url">plugins/servlet/teamserverConnect</param>
    </plugin-info>

    <web-resource key="configuration.js" name="contrast-bamboo-plugin Configuration javascript">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <resource type="download" name="contrast-bamboo-plugin.js" location="js/contrast-bamboo-plugin.js">
            <param name="content-type" value="application/javascript"/>
        </resource>
        <context>atl.admin</context>
    </web-resource>

    <taskType key="teamserver-threshold-task" name="Contrast Vulnerability Threshold" class="com.contrastsecurity.VerifyThresholdsTask">
        <description>A task for registering TeamServer results as build conditions.</description>
        <configuration class="com.contrastsecurity.TeamServerTaskConfiguration"/>
        <resource type="freemarker" name="edit" location="editTeamserverTask.ftl"/>
        <resource type="freemarker" name="view" location="viewTeamserverTask.ftl"/>
        <resource type="download" name="icon" location="images/taskIcon.png"/>
        <help link="ts.task.help.link" title="ts.task.help.title" />
    </taskType>

    <servlet name="contrast-bamboo-plugin" class="com.contrastsecurity.ConnectionServlet" key="teamserver-config">
        <url-pattern>/teamserverConnect</url-pattern>
    </servlet>

    <web-item key="bamboo-menu-item"
        name="Contrast Admin Page"
        section="system.admin/plugins"
        weight="10"
        application="bamboo">
        <description>Link to Contrast TeamServer Configuration page.</description>
        <label key="TeamServer Profiles"/>
        <link linkId="teamserver-admin-link">/plugins/servlet/teamserverConnect</link>
    </web-item>

    <rest name="TeamServer REST Resource" key="contrast-rest" path="/teamserver-admin" version="1.0">
        <description>Provides REST resources for the Configuration UI.</description>
    </rest>

    <report key="contrastSeverity" name="Severity Trends Across Builds"
            class="com.contrastsecurity.SeverityReportCollector">
        <description>Comparing success percentages gives you an idea of how stable a build is compared to one another.
            100% means your build is always rock solid. 0% means something is seriously wrong.</description>
        <chartClass>com.contrastsecurity.ContrastSeverityReportChart</chartClass>
    </report>
    <report key="test" name="Percentage of Test Successful Builds"
            class="com.atlassian.bamboo.reports.collector.RatioOfSuccessCollector">
        <description>Yee</description>
        <chartClass>com.atlassian.bamboo.reports.charts.BuildSummarySuccessRatioLineChart</chartClass>
    </report>

    <ao key="ao-module">
        <description>The module configuring the Active Objects service used by this plugin</description>
        <entity>com.contrastsecurity.Finding</entity>
    </ao>
    <component-import key="ao" name="Active Objects service" interface="com.atlassian.activeobjects.external.ActiveObjects">
          <description>Component to access Active Objects functionality from the plugin</description>
    </component-import>


    <resource type="i18n" name="language" location="com.contrastsecurity.contrast-bamboo-plugin.i18n"/>
</atlassian-plugin>
